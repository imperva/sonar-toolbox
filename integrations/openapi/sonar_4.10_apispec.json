{"openapi":"3.0.1","info":{"title":"DSF Data Security Fabric Open APIs","description":"DSF Data Security Fabric Open APIs Documentation","license":{"name":"The terms in the absence of an applicable signed agreement between you and Imperva","url":"https://www.imperva.com/legal/license-agreement/"},"version":"1.0.0"},"servers":[{"url":"https://localhost:27900//","description":"Imperva API server"}],"security":[{"api_key":[]},{"api_id":[]}],"paths":{"/api/v1/log-aggregators":{"get":{"tags":["log-aggregator-controller-impl"],"summary":"Get all log aggregators","operationId":"getAssets","responses":{"503":{"description":"Error message","content":{"application/json":{"example":{"errors":[{"status":503,"id":"4dc2029a311309c5","source":{"pointer":"/dsf/api/v1/asset"},"title":"Service Unavailable","detail":"'DSF Hub' is not responding, check if it is running or try again later"}]}}}},"200":{"description":"Log aggregator","content":{"application/json":{"example":{"data":[{"applianceId":1,"applianceType":"DSF_HUB","id":"event hub id 1","name":"azure mssql eventhub 1","serverType":"AZURE EVENTHUB","ip":"1.1.1.1","hostname":"hostname","ports":["443"],"gatewayName":"uscSonarMachine10","auditState":"NO","gatewayId":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","remoteSyncState":"SYNCED","isMonitored":false},{"applianceId":1,"applianceType":"DSF_HUB","id":"event hub id 2","name":"azure mssql eventhub 2","serverType":"AZURE EVENTHUB","ip":"2.2.2.2","hostname":"hostname","ports":["443"],"gatewayName":"uscSonarMachine10","auditState":"NO","gatewayId":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","remoteSyncState":"SYNCED","isMonitored":false}]}}}}}},"post":{"tags":["log-aggregator-controller-impl"],"summary":"Create log aggregator","operationId":"createAsset","requestBody":{"description":"Details of the item to be created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIDataAssetDto"},"examples":{"An example of request body.":{"summary":"AZURE EVENTHUB","description":"An example of request body.","value":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"azure mssql eventhub","serverType":"AZURE EVENTHUB","auditState":"NO","assetData":{"Server Host Name":"hostname","Server IP":"1.1.1.1","Server Port":443,"Server Type":"AZURE EVENTHUB","Service Name":"","admin_email":"person@company.com","asset_display_name":"azure mssql eventhub","asset_id":"azure mssql eventhub","asset_source":"OTHER, N/A","jsonar_uid":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","jsonar_uid_display_name":"uscSonarMachine10","managed_by":"person@company.com","owned_by":"person@company.com","timestamp":"2022-09-28T20:26:59.289581","auth_mechanism":"default","azure_storage_account":"storage1sql1dummy","azure_storage_container":"automationcontainerdummy","azure_storage_secret_key":"*****","checkpointMsgCount":100,"eventhub_access_key":"*****","eventhub_access_policy":"RootManageSharedAccessKey","eventhub_name":"eventhub-sql","eventhub_namespace":"eventnamespace-sql","format":"Sql"},"gatewayId":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","remoteSyncState":"SYNCED","isMonitored":false}}}}}},"required":true},"responses":{"400":{"description":"Asset with ID 'azure mssql eventhub' already exists in 'DSF Hub'","content":{"application/json":{}}},"201":{"description":"Log aggregator","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"azure mssql eventhub","serverType":"AZURE EVENTHUB","auditState":"NO","assetData":{"Server Host Name":"hostname","Server IP":"1.1.1.1","Server Port":443,"Server Type":"AZURE EVENTHUB","Service Name":"","admin_email":"person@company.com","asset_display_name":"azure mssql eventhub","asset_id":"azure mssql eventhub","asset_source":"OTHER, N/A","jsonar_uid":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","jsonar_uid_display_name":"uscSonarMachine10","managed_by":"person@company.com","owned_by":"person@company.com","timestamp":"2022-09-28T20:26:59.289581","auth_mechanism":"default","azure_storage_account":"storage1sql1dummy","azure_storage_container":"automationcontainerdummy","azure_storage_secret_key":"*****","checkpointMsgCount":100,"eventhub_access_key":"*****","eventhub_access_policy":"RootManageSharedAccessKey","eventhub_name":"eventhub-sql","eventhub_namespace":"eventnamespace-sql","format":"Sql"},"gatewayId":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","remoteSyncState":"SYNCED","isMonitored":false}}}}}}}},"/api/v1/log-aggregators/{id}":{"get":{"tags":["log-aggregator-controller-impl"],"summary":"Get log aggregator","operationId":"getAsset","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"responses":{"404":{"description":"Cannot find asset with ID 'asset ID' in 'DSF Hub'","content":{"application/json":{"example":{"errors":[{"status":404,"id":"348c9f563803ca23","source":{"pointer":"/dsf/api/v1/asset/asset_id"},"title":"Not Found","detail":"Cannot find asset with ID 'asset ID' in 'DSF Hub'"}]}}}},"200":{"description":"Log aggregator","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"azure mssql eventhub","serverType":"AZURE EVENTHUB","auditState":"NO","assetData":{"Server Host Name":"hostname","Server IP":"1.1.1.1","Server Port":443,"Server Type":"AZURE EVENTHUB","Service Name":"","admin_email":"person@company.com","asset_display_name":"azure mssql eventhub","asset_id":"azure mssql eventhub","asset_source":"OTHER, N/A","jsonar_uid":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","jsonar_uid_display_name":"uscSonarMachine10","managed_by":"person@company.com","owned_by":"person@company.com","timestamp":"2022-09-28T20:26:59.289581","auth_mechanism":"default","azure_storage_account":"storage1sql1dummy","azure_storage_container":"automationcontainerdummy","azure_storage_secret_key":"*****","checkpointMsgCount":100,"eventhub_access_key":"*****","eventhub_access_policy":"RootManageSharedAccessKey","eventhub_name":"eventhub-sql","eventhub_namespace":"eventnamespace-sql","format":"Sql"},"gatewayId":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","remoteSyncState":"SYNCED","isMonitored":false}}}}}}},"post":{"tags":["log-aggregator-controller-impl"],"summary":"Update log aggregator","operationId":"updateAsset","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"requestBody":{"description":"Details of the item to be created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIDataAssetDto"},"examples":{"An example of request body.":{"summary":"AZURE EVENTHUB","description":"An example of request body.","value":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"azure mssql eventhub","serverType":"AZURE EVENTHUB","auditState":"NO","assetData":{"Server Host Name":"hostname","Server IP":"1.1.1.1","Server Port":443,"Server Type":"AZURE EVENTHUB","Service Name":"","admin_email":"person@company.com","asset_display_name":"azure mssql eventhub","asset_id":"azure mssql eventhub","asset_source":"OTHER, N/A","jsonar_uid":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","jsonar_uid_display_name":"uscSonarMachine10","managed_by":"person@company.com","owned_by":"person@company.com","timestamp":"2022-09-28T20:26:59.289581","auth_mechanism":"default","azure_storage_account":"storage1sql1dummy","azure_storage_container":"automationcontainerdummy","azure_storage_secret_key":"*****","checkpointMsgCount":100,"eventhub_access_key":"*****","eventhub_access_policy":"RootManageSharedAccessKey","eventhub_name":"eventhub-sql","eventhub_namespace":"eventnamespace-sql","format":"Sql"},"gatewayId":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","remoteSyncState":"SYNCED","isMonitored":false}}}}}},"required":true},"responses":{"400":{"description":"Asset with ID 'azure mssql eventhub' already exists in 'DSF Hub'","content":{"application/json":{}}},"201":{"description":"Log aggregator","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"azure mssql eventhub","serverType":"AZURE EVENTHUB","auditState":"NO","assetData":{"Server Host Name":"hostname","Server IP":"1.1.1.1","Server Port":443,"Server Type":"AZURE EVENTHUB","Service Name":"","admin_email":"person@company.com","asset_display_name":"azure mssql eventhub","asset_id":"azure mssql eventhub","asset_source":"OTHER, N/A","jsonar_uid":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","jsonar_uid_display_name":"uscSonarMachine10","managed_by":"person@company.com","owned_by":"person@company.com","timestamp":"2022-09-28T20:26:59.289581","auth_mechanism":"default","azure_storage_account":"storage1sql1dummy","azure_storage_container":"automationcontainerdummy","azure_storage_secret_key":"*****","checkpointMsgCount":100,"eventhub_access_key":"*****","eventhub_access_policy":"RootManageSharedAccessKey","eventhub_name":"eventhub-sql","eventhub_namespace":"eventnamespace-sql","format":"Sql"},"gatewayId":"00a9eee6-a562-401b-9ff9-3a97d560cfb3","remoteSyncState":"SYNCED","isMonitored":false}}}}}}},"delete":{"tags":["log-aggregator-controller-impl"],"summary":"Delete log aggregator","operationId":"deleteAsset","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"Cannot find asset with ID 'asset ID' in DSF Hub","content":{"application/json":{"example":{"errors":[{"status":404,"id":"7a0ec5d103ea0ed7","source":{"pointer":"/dsf/api/v1/assets/arn:aws:rds:us-east-2:644748426467:cluster:avivit-aurora-postgres13-junversss"},"title":"Not Found","detail":"Cannot find asset with ID 'asset ID' in 'DSF Hub'"}]}}}},"200":{"description":"The delete result","content":{"application/json":{"example":"{data\" : \"Asset 'asset ID' was sent for deletion using playbook 'playbook ID'\"}"}}}}}},"/api/v1/log-aggregators/{id}/operations/test-connection":{"post":{"tags":["log-aggregator-controller-impl"],"summary":"Test log aggregator connection","operationId":"testConnectionOperation","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"examples":{"SUCCESS":{"description":"SUCCESS","value":{"data":{"status":"SUCCESS","message":"Connection was successfully established"}}},"FAILED":{"description":"FAILED","value":{"data":{"status":"FAILED","message":"Server Type AZURE EVENTHUB isn't supported when testing connections"}}}}}}}}}},"/api/v1/data-sources":{"get":{"tags":["data-source-controller-impl"],"summary":"Get all data sources","operationId":"getAssets_1","responses":{"200":{"description":"Data sources","content":{"application/json":{"example":{"data":[{"applianceId":1,"applianceType":"DSF_HUB","id":"arn:aws:id","name":"jackson-mssql-1","serverType":"AWS RDS MsSQL Server","ip":"the ip address","hostname":"the hostname","ports":["1433"],"gatewayName":"uscSonarMachine10","auditState":"NO","serviceName":"MSSQLSERVER","parentAssetId":"arn:aws:iam::","assetVersion":"14","gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","remoteSyncState":"SYNCED","capabilities":["EDIT"],"isMonitored":false},{"applianceId":1,"applianceType":"DSF_HUB","id":"arn:aws:id2","name":"jackson-mssql-2","serverType":"AWS RDS MsSQL Server","ip":"the ip address","hostname":"the hostname","ports":["1433"],"gatewayName":"uscSonarMachine10","auditState":"NO","serviceName":"MSSQLSERVER","parentAssetId":"arn:aws:iam::","assetVersion":"14","gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","remoteSyncState":"SYNCED","capabilities":["EDIT"],"isMonitored":false}]}}}},"503":{"description":"Error message","content":{"application/json":{"example":{"errors":[{"status":503,"id":"4dc2029a311309c5","source":{"pointer":"/dsf/api/v1/asset"},"title":"Service Unavailable","detail":"'DSF Hub' is not responding, check if it is running or try again later"}]}}}}}},"post":{"tags":["data-source-controller-impl"],"summary":"Create a data source","operationId":"createAsset_1","requestBody":{"description":"Details of the item to be created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIDataAssetDto"},"examples":{"An example of request body.":{"summary":"AWS RDS AURORA POSTGRESQL","description":"An example of request body.","value":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"ARN:AWS:TEST_API","serverType":"AWS RDS AURORA POSTGRESQL","auditState":"NO","assetData":{"Server Host Name":"Hostname","Server IP":"ARN:AWS:TEST_API","Server Port":5432,"Server Type":"AWS RDS AURORA POSTGRESQL","Service Name":"","admin_email":"person@company.com","application":"application name","arn":"ARN:AWS:TEST_API","asset_display_name":"asset display name new","asset_id":"ARN:AWS:TEST_API","asset_source":"jSonar","audit_pull_enabled":false,"audit_type":"Audit type","cluster_id":"cluster id","cluster_member_id":"cluster member id","cluster_name":"cluster name","criticality":1,"database_name":"master","db_engine":"oracle","gateway_service":"GTW service","jsonar_uid":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","jsonar_uid_display_name":"uscSonarMachine10","location":"location","logs_destination_asset_id":"logs location","managed_by":"person@company.com","max_concurrent_conn":"10","owned_by":"person@company.com","parent_asset_id":"arn:aws:iam","proxy":"proxy","region":"region","timestamp":"2022-09-20T10:07:29.068280","used_for":"DEV","version":5.7,"virtual_hostname":"V host","virtual_ip":"V ip","auth_mechanism":"password","password":"*****","username":"username"},"parentAssetId":"arn:aws:iam","gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","isMonitored":false}}}}}},"required":true},"responses":{"201":{"description":"Data source","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"ARN:AWS:TEST_API","serverType":"AWS RDS AURORA POSTGRESQL","auditState":"NO","assetData":{"Server Host Name":"Hostname","Server IP":"ARN:AWS:TEST_API","Server Port":5432,"Server Type":"AWS RDS AURORA POSTGRESQL","Service Name":"","admin_email":"person@company.com","application":"application name","arn":"ARN:AWS:TEST_API","asset_display_name":"asset display name new","asset_id":"ARN:AWS:TEST_API","asset_source":"jSonar","audit_pull_enabled":false,"audit_type":"Audit type","cluster_id":"cluster id","cluster_member_id":"cluster member id","cluster_name":"cluster name","criticality":1,"database_name":"master","db_engine":"oracle","gateway_service":"GTW service","jsonar_uid":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","jsonar_uid_display_name":"uscSonarMachine10","location":"location","logs_destination_asset_id":"logs location","managed_by":"person@company.com","max_concurrent_conn":"10","owned_by":"person@company.com","parent_asset_id":"arn:aws:iam","proxy":"proxy","region":"region","timestamp":"2022-09-20T10:07:29.068280","used_for":"DEV","version":5.7,"virtual_hostname":"V host","virtual_ip":"V ip","auth_mechanism":"password","password":"*****","username":"username"},"parentAssetId":"arn:aws:iam","gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","isMonitored":false}}}}},"400":{"description":"Data source already exist","content":{"application/json":{"example":{"errors":[{"status":400,"id":"682b3eb3fe7abe08","source":{"pointer":"/dsf/api/v1/data-sources"},"title":"Bad Request","detail":"Asset with ID 'ARN' already exists in 'DSF Hub'"}]}}}}}}},"/api/v1/data-sources/{id}":{"get":{"tags":["data-source-controller-impl"],"summary":"Get data source","operationId":"getAsset_1","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"responses":{"404":{"description":"Data source does not exist","content":{"application/json":{"example":{"errors":[{"status":404,"id":"2982f1f5270db626","source":{"pointer":"/dsf/api/v1/data-sources/wrong%20data%20source"},"title":"Not Found","detail":"Cannot find asset with ID 'wrong data source' in 'DSF Hub'"}]}}}},"200":{"description":"Data source","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"ARN:AWS:TEST_API","serverType":"AWS RDS AURORA POSTGRESQL","auditState":"NO","assetData":{"Server Host Name":"Hostname","Server IP":"ARN:AWS:TEST_API","Server Port":5432,"Server Type":"AWS RDS AURORA POSTGRESQL","Service Name":"","admin_email":"person@company.com","application":"application name","arn":"ARN:AWS:TEST_API","asset_display_name":"asset display name new","asset_id":"ARN:AWS:TEST_API","asset_source":"jSonar","audit_pull_enabled":false,"audit_type":"Audit type","cluster_id":"cluster id","cluster_member_id":"cluster member id","cluster_name":"cluster name","criticality":1,"database_name":"master","db_engine":"oracle","gateway_service":"GTW service","jsonar_uid":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","jsonar_uid_display_name":"uscSonarMachine10","location":"location","logs_destination_asset_id":"logs location","managed_by":"person@company.com","max_concurrent_conn":"10","owned_by":"person@company.com","parent_asset_id":"arn:aws:iam","proxy":"proxy","region":"region","timestamp":"2022-09-20T10:07:29.068280","used_for":"DEV","version":5.7,"virtual_hostname":"V host","virtual_ip":"V ip","auth_mechanism":"password","password":"*****","username":"username"},"parentAssetId":"arn:aws:iam","gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","remoteSyncState":"SYNCED","isMonitored":false}}}}}}},"post":{"tags":["data-source-controller-impl"],"summary":"Update a data source","operationId":"updateAsset_1","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"requestBody":{"description":"Details of the item to be updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIDataAssetDto"},"examples":{"An example of request body.":{"summary":"AWS RDS AURORA POSTGRESQL","description":"An example of request body.","value":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"ARN:AWS:TEST_API","serverType":"AWS RDS AURORA POSTGRESQL","auditState":"NO","assetData":{"Server Host Name":"Hostname","Server IP":"ARN:AWS:TEST_API","Server Port":5432,"Server Type":"AWS RDS AURORA POSTGRESQL","Service Name":"","admin_email":"person@company.com","application":"application name","arn":"ARN:AWS:TEST_API","asset_display_name":"asset display name new","asset_id":"ARN:AWS:TEST_API","asset_source":"jSonar","audit_pull_enabled":false,"audit_type":"Audit type","cluster_id":"cluster id","cluster_member_id":"cluster member id","cluster_name":"cluster name","criticality":1,"database_name":"master","db_engine":"oracle","gateway_service":"GTW service","jsonar_uid":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","jsonar_uid_display_name":"uscSonarMachine10","location":"location","logs_destination_asset_id":"logs location","managed_by":"person@company.com","max_concurrent_conn":"10","owned_by":"person@company.com","parent_asset_id":"arn:aws:iam","proxy":"proxy","region":"region","timestamp":"2022-09-20T10:07:29.068280","used_for":"DEV","version":5.7,"virtual_hostname":"V host","virtual_ip":"V ip","auth_mechanism":"password","password":"*****","username":"username"},"parentAssetId":"arn:aws:iam","gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","isMonitored":false}}}}}},"required":true},"responses":{"404":{"description":"Data source does not exist","content":{"application/json":{"example":{"errors":[{"status":404,"id":"f66301f7c3b0fc07","source":{"pointer":"/dsf/api/v1/data-sources/wrong%20data%20source"},"title":"Not Found","detail":"Cannot find asset with ID 'wrong data source' in 'DSF Hub'"}]}}}},"400":{"description":"Invalid configuration","content":{"application/json":{"example":{"errors":[{"status":400,"id":"fa311687a1795427","source":{"pointer":"/dsf/api/v1/data-sources"},"title":"Bad Request","detail":"Asset attribute type does not match required: audit_info ('dict' required but 'String' detected)"}]}}}},"201":{"description":"Data source","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"ARN:AWS:TEST_API","serverType":"AWS RDS AURORA POSTGRESQL","auditState":"NO","assetData":{"Server Host Name":"Hostname","Server IP":"ARN:AWS:TEST_API","Server Port":5432,"Server Type":"AWS RDS AURORA POSTGRESQL","Service Name":"","admin_email":"person@company.com","application":"application name","arn":"ARN:AWS:TEST_API","asset_display_name":"asset display name new","asset_id":"ARN:AWS:TEST_API","asset_source":"jSonar","audit_pull_enabled":false,"audit_type":"Audit type","cluster_id":"cluster id","cluster_member_id":"cluster member id","cluster_name":"cluster name","criticality":1,"database_name":"master","db_engine":"oracle","gateway_service":"GTW service","jsonar_uid":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","jsonar_uid_display_name":"uscSonarMachine10","location":"location","logs_destination_asset_id":"logs location","managed_by":"person@company.com","max_concurrent_conn":"10","owned_by":"person@company.com","parent_asset_id":"arn:aws:iam::","proxy":"proxy","region":"region","timestamp":"2022-09-20T10:07:29.068280","used_for":"DEV","version":5.7,"virtual_hostname":"V host","virtual_ip":"V ip","auth_mechanism":"password","password":"*****","username":"username"},"parentAssetId":"arn:aws:iam","gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","isMonitored":false}}}}}}},"delete":{"tags":["data-source-controller-impl"],"summary":"Delete a data source","operationId":"deleteAsset_1","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"The delete result","content":{"application/json":{"example":{"data":"Asset ARN:AWS:TEST_API was sent for deletion using playbook 84752428-e1c8-4f43-b1fb-2f41cee7b94b"}}}},"404":{"description":"Data source does not exist","content":{"application/json":{"example":{"errors":[{"status":404,"id":"88e694ef6c3e81ac","source":{"pointer":"/dsf/api/v1/data-sources/wrong%20data%20source"},"title":"Not Found","detail":"Cannot find asset with ID 'wrong data source' in 'DSF Hub'"}]}}}}}}},"/api/v1/data-sources/{id}/operations/test-connection":{"post":{"tags":["data-source-controller-impl"],"summary":"Test data source connection","operationId":"testConnectionOperation_1","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"examples":{"SUCCESS":{"description":"SUCCESS","value":{"data":{"status":"SUCCESS","message":"Connection was successfully established"}}},"FAILED":{"description":"FAILED","value":{"data":{"status":"FAILED","message":"Error getting connection for asset aws-vs-test-1334 without a reason. Error: Unable to establish connection due to error (2003, \"Can't connect to MySQL server on 'my-host' ([Errno -3] Temporary failure in name resolution)\")"}}}}}}}}}},"/api/v1/data-sources/{id}/operations/enable-audit-collection":{"post":{"tags":["data-source-controller-impl"],"summary":"Enable data source audit collection","operationId":"enableAuditCollectionOperation","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"responses":{"200":{"description":"Operation completed successfully","content":{"application/json":{"example":{"data":"b9355234-d961-423e-85a5-fa899c5bac98"}}}},"404":{"description":"Data source does not exist","content":{"application/json":{"example":{"errors":[{"status":404,"id":"2982f1f5270db626","source":{"pointer":"/dsf/api/v1/data-sources/wrong%20data%20source"},"title":"Not Found","detail":"Cannot find asset with ID 'wrong data source' in 'DSF Hub'"}]}}}}}}},"/api/v1/data-sources/{id}/operations/disable-audit-collection":{"post":{"tags":["data-source-controller-impl"],"summary":"Disable data source audit collection","operationId":"disableAuditCollectionOperation","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"responses":{"200":{"description":"Operation completed successfully","content":{"application/json":{"example":{"data":"b9355234-d961-423e-85a5-fa899c5bac98"}}}},"404":{"description":"Data source does not exist","content":{"application/json":{"example":{"errors":[{"status":404,"id":"2982f1f5270db626","source":{"pointer":"/dsf/api/v1/data-sources/wrong%20data%20source"},"title":"Not Found","detail":"Cannot find asset with ID 'wrong data source' in 'DSF Hub'"}]}}}}}}},"/api/v1/cloud-accounts":{"get":{"tags":["cloud-account-controller-impl"],"summary":"Get all cloud accounts","operationId":"getCloudAccounts","parameters":[{"name":"type","in":"query","description":"Cloud account type. Possible values: AWS, Azure","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"Cloud accounts","content":{"application/json":{"example":{"data":[{"id":"asset-azure-1","serverType":"AZURE","discoveredAssets":2,"applianceType":"SONAR","applianceId":1},{"id":"aws_basic","serverType":"AWS","discoveredAssets":1,"applianceType":"SONAR","applianceId":1}]}}}},"400":{"description":"Wrong appliance type","content":{"application/json":{}}}}},"post":{"tags":["cloud-account-controller-impl"],"summary":"Create cloud account","operationId":"createCloudAccount","requestBody":{"description":"Details of the item to be created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIDataAssetDto"},"examples":{"An example of request body.":{"summary":"AWS cloud account","description":"An example of request body.","value":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"AWS:ARN:ID:test:1","serverType":"AWS","assetData":{"arn":"AWS:ARN:ID:test:1","asset_display_name":"AWS cloud account for testing rename","serverType":"AWS","authMechanism":"key","accessId":"accessID_AWS_","secretKey":"s.key","region":"region"},"gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45"}}}}}},"required":true},"responses":{"200":{"description":"A cloud account","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"AWS:ARN:ID:test:1","serverType":"AWS","auditState":"NO","assetData":{"Server Host Name":"$arn","Server IP":"$arn","Server Port":"443","Server Type":"AWS","Service Name":"","admin_email":"person@company.com","arn":"AWS:ARN:ID:test:1","asset_display_name":"AWS cloud account for testing","asset_id":"AWS:ARN:ID:test:1","asset_source":"jSonar","jsonar_uid":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","jsonar_uid_display_name":"uscSonarMachine10","managed_by":"person@company.com","owned_by":"person@company.com","region":"region","timestamp":"2022-09-25T06:47:51.326572"},"gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","isMonitored":false}}}}},"400":{"description":"Cloud account already exist","content":{"application/json":{"example":{"errors":[{"status":400,"id":"a10ec59e5c3d8a83","source":{"pointer":"/dsf/api/v1/cloud-accounts/"},"title":"Bad Request","detail":"Asset with ID 'AWS:ARN:ID:test:1' already exists in 'DSF Hub'"}]}}}}}}},"/api/v1/cloud-accounts/{id}":{"get":{"tags":["cloud-account-controller-impl"],"summary":"Get cloud account","operationId":"getCloudAccount","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Cloud account","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","serverType":"AWS","auditState":"NO","assetData":{"Server Host Name":"hostname","Server IP":"IP","Server Port":9999,"Server Type":"AWS","Service Name":"serviceName","admin_email":"tester@mail.me","arn":"","asset_display_name":"Basic AWS Account (VS)","asset_id":"arn:aws:id","asset_source":"usc","discovery_last_run":"2022-09-14T12:46:40.785000Z","jsonar_uid":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","jsonar_uid_display_name":"uscSonarMachine10","managed_by":"tester@mail.me","owned_by":"tester@mail.me","region":"us-east-2","timestamp":"2022-09-14T12:26:24.168104","access_id":"access_id","auth_mechanism":"key","secret_key":"*****"},"gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","remoteSyncState":"SYNCED","isMonitored":false}}}}},"404":{"description":"Cloud account does not exist","content":{"application/json":{"example":{"errors":[{"status":404,"id":"0230794aaa4c0534","source":{"pointer":"/dsf/api/v1/cloud-accounts/wrong%20cloud%20accont%20id"},"title":"Not Found","detail":"Cannot find asset with ID 'wrong cloud accont id' in 'DSF Hub'"}]}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"example":{"errors":[{"status":500,"id":"b726e1081955a1e9","source":{"pointer":"/dsf/api/v1/cloud-accounts/wrong%20cloud%20account"},"title":"Internal Server Error","detail":"'DSF Hub' is not responding, check if it is running or try again later"}]}}}}}},"post":{"tags":["cloud-account-controller-impl"],"summary":"Update cloud account","operationId":"updateAsset_2","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"requestBody":{"description":"Details of the item to be updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIDataAssetDto"},"examples":{"An example of request body.":{"summary":"AWS cloud account","description":"An example of request body.","value":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"AWS:ARN:ID:test:1","serverType":"AWS","assetData":{"arn":"AWS:ARN:ID:test:1","asset_display_name":"AWS cloud account for testing rename","serverType":"AWS","authMechanism":"key","accessId":"accessID_AWS_","secretKey":"s.key","region":"region"},"gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45"}}}}}},"required":true},"responses":{"400":{"description":"Field 'field_id' is missing","content":{"application/json":{"example":{"errors":[{"status":400,"id":"829faa57f90bd4d9","source":{"pointer":"/dsf/api/v1/cloud-accounts/AWS:ARN:ID:test:1"},"title":"Bad Request","detail":"Asset attributes or groups required but not found: admin_email"}]}}}},"200":{"description":"A cloud account","content":{"application/json":{"example":{"data":{"applianceId":1,"applianceType":"DSF_HUB","id":"ARN_NEW","serverType":"AWS","auditState":"NO","assetData":{"Server Host Name":"Hostname","Server IP":"$arn","Server Port":5432,"Server Type":"AWS","Service Name":"","admin_email":"person@company.com","arn":"ARN_NEW","asset_display_name":"cloud account name","asset_id":"ARN_NEW","asset_source":"jSonar","jsonar_uid":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","jsonar_uid_display_name":"uscSonarMachine10","managed_by":"person@company.com","owned_by":"person@company.com","region":"region","timestamp":"2022-09-20T07:20:25.609848","auth_mechanism":"iam_role"},"gatewayId":"518a6b1f-f25d-4661-bf5d-efb840c3ed45","isMonitored":false}}}}}}},"delete":{"tags":["cloud-account-controller-impl"],"summary":"Delete cloud account","operationId":"deleteCloudAccount","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"The delete result","content":{"application/json":{"example":{"data":"Asset AWS:ARN:ID was sent for deletion using playbook ab401640-f467-4c88-ae44-ea52ea9a869a"}}}},"404":{"description":"Cloud account does not exist","content":{"application/json":{"example":{"errors":[{"status":404,"id":"a7d3c2f91958953a","source":{"pointer":"/dsf/api/v1/cloud-accounts/wrong%20cloud%20account%20name"},"title":"Not Found","detail":"Cannot find asset with ID 'wrong cloud account name' in 'DSF Hub'"}]}}}}}}},"/api/v1/cloud-accounts/{id}/operations/trigger-discovery":{"post":{"tags":["cloud-account-controller-impl"],"summary":"Trigger discovery operation","operationId":"discover","parameters":[{"name":"id","in":"path","required":true,"schema":{"maxLength":1000,"minLength":0,"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIDataDiscoveryRequestDto"}}},"required":true},"responses":{"404":{"description":"Cloud account does not exist","content":{"application/json":{"example":{"errors":[{"status":404,"id":"7e8257017439c6ab","source":{"pointer":"/dsf/api/v1/cloud-accounts/wrong%20cloud%20account/operations/trigger-discovery"},"title":"Not Found","detail":"Cannot find cloud account with ID 'wrong cloud account' in 'DSF Hub'"}]}}}},"200":{"description":"The trigger discovery operation result","content":{"application/json":{"example":{"data":"eb11f067-8b4f-4be4-9275-34cb3353ba5f;4de23438-60f4-455c-a4d6-b385d9c66731;"}}}}}}},"/api/v1/cloud-accounts/{id}/operations/test-connection":{"post":{"tags":["cloud-account-controller-impl"],"summary":"Test connection on a Cloud Account","operationId":"checkConnectivity","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"examples":{"SUCCESS":{"description":"SUCCESS","value":{"data":{"status":"SUCCESS","message":"Successfully established connection to asset arn:aws:id"}}},"FAILED":{"description":"FAILED","value":{"data":{"status":"FAILED","message":"Error getting connection for asset AWS:ARN:ID. Error: Unable to establish connection due to error: 'error message'"}}}}}}}}}}},"components":{"schemas":{"APIDataAssetDto":{"type":"object","properties":{"data":{"$ref":"#/components/schemas/AssetDto"}}},"AssetConnectionDto":{"required":["authMechanism"],"type":"object","properties":{"id":{"type":"string"},"purpose":{"maxLength":50,"minLength":0,"type":"string"},"authMechanism":{"maxLength":50,"minLength":1,"type":"string"},"username":{"maxLength":100,"minLength":0,"type":"string"},"password":{"maxLength":100,"minLength":0,"type":"string"},"databaseName":{"maxLength":200,"minLength":0,"type":"string"},"region":{"type":"string"},"secretKey":{"maxLength":200,"minLength":1,"type":"string"},"accessId":{"maxLength":200,"minLength":1,"type":"string"},"arn":{"maxLength":200,"minLength":1,"type":"string"},"externalId":{"maxLength":200,"minLength":1,"type":"string"},"keyFile":{"maxLength":300,"minLength":1,"type":"string"},"subscriptionId":{"maxLength":200,"minLength":1,"type":"string"},"tenantId":{"maxLength":200,"minLength":1,"type":"string"},"clientId":{"maxLength":200,"minLength":1,"type":"string"},"clientSecret":{"maxLength":200,"minLength":1,"type":"string"}}},"AssetDto":{"required":["agent","applianceId","applianceType","assetData","gatewayGroup","hostname","id","ip","name","ports","serverType"],"type":"object","properties":{"applianceId":{"type":"integer","format":"int64"},"applianceType":{"type":"string","enum":["NOT_APPLICABLE","DSF_HUB","MX"]},"id":{"maxLength":1000,"minLength":0,"type":"string"},"name":{"maxLength":500,"minLength":0,"type":"string"},"serverType":{"maxLength":50,"minLength":0,"type":"string"},"ip":{"maxLength":1000,"minLength":0,"type":"string"},"hostname":{"maxLength":500,"minLength":0,"type":"string"},"ports":{"maxItems":100,"minItems":1,"uniqueItems":true,"type":"array","items":{"type":"string"}},"gatewayName":{"maxLength":500,"minLength":0,"type":"string"},"auditState":{"type":"string","enum":["YES","NO","PARTIAL"]},"policies":{"maxItems":100000,"minItems":1,"uniqueItems":true,"type":"array","items":{"type":"string"}},"agent":{"maxLength":500,"minLength":0,"type":"string"},"groups":{"$ref":"#/components/schemas/GroupDto"},"gatewayGroup":{"maxLength":500,"minLength":0,"type":"string"},"assetData":{"type":"object","properties":{"reason":{"type":"string"},"applianceId":{"type":"integer","format":"int64"},"assetId":{"type":"string"},"serverType":{"type":"string"},"parentAssetId":{"type":"string"},"auditPullEnabled":{"type":"boolean"},"jsonarUid":{"type":"string"},"jsonarUidDisplayName":{"type":"string"},"lastDiscovered":{"type":"string"},"authMechanism":{"type":"string"},"internalId":{"type":"string"},"empty":{"type":"boolean"}},"additionalProperties":{"type":"object"}},"serviceName":{"maxLength":500,"minLength":0,"type":"string"},"parentAssetId":{"maxLength":1000,"minLength":0,"type":"string"},"region":{"maxLength":50,"minLength":0,"type":"string"},"assetVersion":{"maxLength":50,"minLength":0,"type":"string"},"gatewayId":{"maxLength":500,"minLength":0,"type":"string"},"remoteSyncState":{"type":"string","enum":["SYNCED","NOT_SYNCED","UNKNOWN"]},"adminEmail":{"maxLength":500,"minLength":0,"type":"string"},"connections":{"type":"array","items":{"$ref":"#/components/schemas/AssetConnectionDto"}},"capabilities":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"isMonitored":{"type":"boolean"}}},"GroupDto":{"type":"object","properties":{"name":{"maxLength":500,"minLength":1,"type":"string"},"serverType":{"maxLength":50,"minLength":1,"type":"string"},"segments":{"maxItems":100,"minItems":0,"type":"array","items":{"type":"string"}}}},"APIDataDiscoveryRequestDto":{"type":"object","properties":{"data":{"$ref":"#/components/schemas/DiscoveryRequestDto"}}},"DiscoveryRequestDto":{"required":["discoveryType"],"type":"object","properties":{"discoveryType":{"type":"string","enum":["AWS_RDS","AWS_REDSHIFT","AZURE","ALL"]},"subscriptionId":{"maxLength":1000,"minLength":1,"type":"string"}}}},"securitySchemes":{"api_key":{"type":"apiKey","description":"An API key created and managed in the Imperva Cloud Security Console and used for authentication","name":"x-API-Key","in":"header"},"api_id":{"type":"apiKey","description":"An API ID created and managed in the Imperva Cloud Security Console and used for authentication","name":"x-API-Id","in":"header"}}}}